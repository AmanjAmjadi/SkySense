<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- SEO Improvements -->
    <title>SkySense Weather - Real-time Weather Forecasts & Alerts | Weather App</title>
    <meta name="description" content="Get accurate weather forecasts, real-time updates, severe weather alerts, and hourly predictions for any location worldwide. Plan your day with SkySense Weather!">
    <meta name="keywords" content="weather, forecast, weather app, weather alerts, hourly forecast, temperature, rain, snow, wind, humidity, UV index, climate, weather report, weather radar, current weather">
    
    <!-- Security: Content Security Policy -->
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline' https://cdn.tailwindcss.com https://cdn.jsdelivr.net https://cdn.datatables.net; style-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net https://cdn.tailwindcss.com; img-src 'self' https://cdn-icons-png.flaticon.com https://upload.wikimedia.org https://cdn.jsdelivr.net https://*.openstreetmap.org https://*.tile.openstreetmap.org data:; connect-src 'self' https://api.open-meteo.com https://geocoding-api.open-meteo.com https://api.openweathermap.org https://*.tile.openstreetmap.org;">
    
    <!-- PWA Support -->
    <meta name="theme-color" content="#5D5CDE">
    <link rel="manifest" href="/manifest.json">
    <link rel="apple-touch-icon" href="/icons/icon-192x192.png">
    
    <!-- Open Graph tags for social sharing -->
    <meta property="og:title" content="SkySense Weather - Accurate Weather Forecasts">
    <meta property="og:description" content="Get real-time weather forecasts, alerts, and hourly predictions for any location worldwide. Plan your day with confidence!">
    <meta property="og:url" content="https://skysenseapp.ir/">
    <meta property="og:type" content="website">
    <meta property="og:image" content="https://skysenseapp.ir/icons/og-image.jpg">
    
    <!-- Twitter Card data -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="SkySense Weather - Accurate Forecasts">
    <meta name="twitter:description" content="Get real-time weather forecasts and alerts for any location">
    <meta name="twitter:image" content="https://skysenseapp.ir/icons/og-image.jpg">
    
    <!-- Mobile app capability -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="SkySense Weather">
    
    <!-- Alternative languages for SEO -->
    <link rel="alternate" hreflang="en" href="https://skysenseapp.ir/">
    <link rel="alternate" hreflang="fa" href="https://skysenseapp.ir/?lang=fa">
    <link rel="alternate" hreflang="ku" href="https://skysenseapp.ir/?lang=ku">
    <link rel="canonical" href="https://skysenseapp.ir/">
    
    <!-- Schema.org JSON-LD for better SEO -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebApplication",
      "name": "SkySense Weather",
      "url": "https://skysenseapp.ir/",
      "description": "Get accurate weather forecasts, real-time updates, severe weather alerts, and hourly predictions for any location worldwide.",
      "applicationCategory": "Weather",
      "operatingSystem": "All",
      "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "USD"
      },
      "aggregateRating": {
        "@type": "AggregateRating",
        "ratingValue": "4.8",
        "reviewCount": "1257"
      }
    }
    </script>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/leaflet@1.9.3/dist/leaflet.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/leaflet@1.9.3/dist/leaflet.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@tabler/icons-webfont@2.30.0/tabler-icons.min.css">
    <!-- Yektanet Ad Script -->
    <script>
        !function(e,t,n){e.yektanetAnalyticsObject=n,e[n]=e[n]||function(){e[n].q.push(arguments)},e[n].q=e[n].q||[];var a=t.getElementsByTagName("head")[0],r=new Date,c="https://cdn.yektanet.com/superscript/5TWMQZeM/native-skysenseapp.ir-42143/yn_pub.js?v="+r.getFullYear().toString()+"0"+r.getMonth()+"0"+r.getDate()+"0"+r.getHours(),s=t.createElement("link");s.rel="preload",s.as="script",s.href=c,a.appendChild(s);var l=t.createElement("script");l.async=!0,l.src=c,a.appendChild(l)}(window,document,"yektanet");
    </script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        primary: '#5D5CDE',
                    },
                    animation: {
                        'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                    }
                }
            }
        }
    </script>
    <link rel="stylesheet" href="styles.css">
</head>
<body class="min-h-screen bg-gray-100 dark:bg-gray-900 transition-colors duration-200">
    <div class="container mx-auto px-4 py-6 max-w-xl">
        <div class="flex justify-between items-center mb-6">
            <h1 class="text-3xl font-bold text-gray-800 dark:text-white" data-en="SkySense" data-fa="اسکای‌سنس" data-ku="سکای‌سێنس">SkySense</h1>
            
            <div class="flex items-center gap-3">
                <!-- Language Selector -->
                <div class="lang-selector" id="lang-selector">
                    <div class="lang-selector-current" aria-label="Change language" role="button" tabindex="0">
                        <div class="lang-selector-flag">
                            <img src="https://cdn-icons-png.flaticon.com/512/323/323310.png" alt="English" id="current-lang-flag">
                        </div>
                        <span id="current-lang-name">EN</span>
                    </div>
                    <div class="lang-selector-options" id="lang-options" role="menu">
                        <div class="lang-option active" data-lang="en" role="menuitem" tabindex="0">
                            <div class="lang-selector-flag">
                                <img src="https://cdn-icons-png.flaticon.com/512/323/323310.png" alt="English">
                            </div>
                            <span>English</span>
                        </div>
                        <div class="lang-option" data-lang="fa" role="menuitem" tabindex="0">
                            <div class="lang-selector-flag">
                                <img src="https://cdn-icons-png.flaticon.com/512/330/330549.png" alt="Persian">
                            </div>
                            <span>فارسی</span>
                        </div>
                        <div class="lang-option" data-lang="ku" role="menuitem" tabindex="0">
                            <div class="lang-selector-flag">
                                <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/3/35/Flag_of_Kurdistan.svg/240px-Flag_of_Kurdistan.svg.png" alt="Kurdish">
                            </div>
                            <span>کوردی</span>
                        </div>
                    </div>
                </div>
                
                <!-- Unit Toggle -->
                <div class="flex items-center gap-2">
                    <span class="text-gray-700 dark:text-gray-300" data-en="°C" data-fa="°C" data-ku="°C">°C</span>
                    <div class="relative inline-block">
                        <input type="checkbox" id="unit-toggle" class="toggle-checkbox" aria-label="Toggle temperature unit" />
                        <label for="unit-toggle" class="toggle-label">
                            <span class="toggle-button"></span>
                        </label>
                    </div>
                    <span class="text-gray-700 dark:text-gray-300" data-en="°F" data-fa="°F" data-ku="°F">°F</span>
                </div>
                
                <!-- Settings Button -->
                <button id="settings-button" class="ml-2 p-2 text-gray-600 dark:text-gray-400 hover:text-primary dark:hover:text-primary transition-colors" aria-label="Settings">
                    <i class="ti ti-settings text-xl"></i>
                </button>
            </div>
        </div>
        
        <!-- Offline Alert Banner -->
        <div id="offline-alert" class="hidden relative border-l-4 border-yellow-400 p-4 bg-yellow-50 dark:bg-yellow-900 dark:border-yellow-600 text-yellow-700 dark:text-yellow-100 rounded-lg mb-4">
            <div class="flex items-center">
                <i class="ti ti-wifi-off text-xl mr-2"></i>
                <div>
                    <p data-en="You are offline. Some features may be limited." data-fa="شما آفلاین هستید. برخی از ویژگی‌ها ممکن است محدود باشند." data-ku="تۆ ئۆفلاینیت. هەندێک تایبەتمەندی لەوانەیە سنووردار بن.">You are offline. Some features may be limited.</p>
                </div>
            </div>
        </div>
        
        <!-- Weather Alerts Container (IMPROVED) -->
        <div id="alerts-container" class="hidden relative border-l-4 p-4 rounded-lg mb-4 pulse-alert">
            <button id="dismiss-alert" class="alert-dismiss" aria-label="Dismiss alert">
                <i class="ti ti-x"></i>
            </button>
            <div class="flex items-start">
                <i id="alert-icon" class="text-xl mr-2 mt-0.5"></i>
                <div>
                    <h3 class="font-semibold" id="alert-title" data-en="Weather Alert" data-fa="هشدار آب و هوا" data-ku="ئاگاداری کەش و هەوا">Weather Alert</h3>
                    <p class="text-sm" id="alert-message"></p>
                    
                    <!-- Alert actions/recommendations -->
                    <div id="alert-actions" class="mt-2 text-sm"></div>
                </div>
            </div>
        </div>
        
        <!-- Favorites Bar -->
        <div id="favorites-container" class="hidden mb-4">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-md p-3">
                <div class="flex justify-between items-center mb-2">
                    <h3 class="text-sm font-medium text-gray-700 dark:text-gray-300" data-en="Favorite Locations" data-fa="مکان‌های مورد علاقه" data-ku="شوێنە دڵخوازەکان">Favorite Locations</h3>
                    <button id="manage-favorites" class="text-xs text-primary hover:underline" data-en="Manage" data-fa="مدیریت" data-ku="بەڕێوەبردن">Manage</button>
                </div>
                <div id="favorites-list" class="flex flex-wrap gap-2"></div>
            </div>
        </div>
        
        <!-- Search and Map Container -->
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg search-container mb-6">
            <div class="flex border-b dark:border-gray-700">
                <button id="searchTab" class="location-tab flex-1 py-3 text-center text-gray-800 dark:text-white font-medium active" role="tab" aria-selected="true" data-en="Search Location" data-fa="جستجوی مکان" data-ku="گەڕان بۆ شوێن">Search Location</button>
                <button id="mapTab" class="location-tab flex-1 py-3 text-center text-gray-800 dark:text-white font-medium" role="tab" aria-selected="false" data-en="Pin on Map" data-fa="نشانه‌گذاری روی نقشه" data-ku="دیاریکردن لەسەر نەخشە">Pin on Map</button>
            </div>
            
            <div id="searchPanel" class="p-6 pb-24" role="tabpanel" aria-labelledby="searchTab">
                <div id="autocompleteContainer">
                    <form id="weatherForm" class="flex flex-col md:flex-row gap-2">
                        <div class="flex-1 relative">
                            <input 
                                type="text" 
                                id="locationInput" 
                                placeholder="City, mountain, desert, sea coordinates..." 
                                data-placeholder-en="City, mountain, desert, sea coordinates..."
                                data-placeholder-fa="شهر، کوه، بیابان، مختصات دریا..."
                                data-placeholder-ku="شار، چیا، بیابان، دووری دەریا..."
                                class="w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 text-base focus:outline-none focus:ring-2 focus:ring-primary dark:bg-gray-700 dark:text-white"
                                autocomplete="off"
                                aria-label="Enter location"
                                required
                            >
                            <div id="autocomplete-list" role="listbox" class="autocomplete-dropdown"></div>
                        </div>
                        <button 
                            type="submit" 
                            class="px-6 py-2 bg-primary text-white rounded-lg hover:bg-opacity-90 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary"
                        >
                            <i class="ti ti-search mr-1"></i> <span data-en="Search" data-fa="جستجو" data-ku="گەڕان">Search</span>
                        </button>
                    </form>
                </div>
                
                <!-- Recent Searches -->
                <div id="recent-searches" class="mt-4 hidden">
                    <h4 class="text-sm font-medium text-gray-700 dark:text-gray-300 mb-2" data-en="Recent Searches" data-fa="جستجوهای اخیر" data-ku="گەڕانە نوێیەکان">Recent Searches</h4>
                    <div id="recent-searches-list" class="flex flex-wrap gap-2"></div>
                </div>
            </div>
            
            <div id="mapPanel" class="hidden p-4" role="tabpanel" aria-labelledby="mapTab">
                <div id="map" class="mb-4" aria-label="Interactive map">
                    <!-- Location Button will be added here by JS -->
                </div>
                <p class="text-sm text-gray-600 dark:text-gray-400 mb-3" data-en="Click anywhere on the map to get weather for that exact location (mountains, deserts, seas, etc.)." data-fa="برای دریافت آب و هوای دقیق هر مکان (کوه، بیابان، دریا و غیره) روی نقشه کلیک کنید." data-ku="کلیک لە هەر شوێنێک بکە لەسەر نەخشەکە بۆ وەرگرتنی کەشوهەوای ئەو شوێنە دیاریکراوە (چیاکان، بیابانەکان، دەریاکان، هتد).">
                    Click anywhere on the map to get weather for that exact location (mountains, deserts, seas, etc.).
                </p>
                <div class="flex flex-wrap items-center gap-2 mb-4">
                    <span class="text-gray-700 dark:text-gray-300" data-en="Selected point:" data-fa="نقطه انتخاب شده:" data-ku="خاڵی دیاریکراو:">Selected point:</span>
                    <span id="selectedLocation" class="px-3 py-1 bg-gray-200 dark:bg-gray-700 rounded-full text-sm text-gray-800 dark:text-white" data-en="None selected" data-fa="هیچ نقطه‌ای انتخاب نشده" data-ku="هیچ دیاری نەکراوە">None selected</span>
                </div>
                <button 
                    id="getWeatherForLocation" 
                    class="w-full px-6 py-2 bg-primary text-white rounded-lg hover:bg-opacity-90 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary disabled:opacity-50 disabled:cursor-not-allowed"
                    disabled
                    data-en="Get Weather"
                    data-fa="دریافت آب و هوا"
                    data-ku="وەرگرتنی کەشوهەوا"
                >
                    Get Weather
                </button>
            </div>
        </div>
        
        <!-- Loading Container with Improved Animations -->
        <div id="loadingContainer" class="flex justify-center items-center py-10">
            <div class="text-center">
                <div class="loading-spinner mx-auto mb-4"></div>
                <p class="text-gray-700 dark:text-gray-300" id="loadingText" data-en="Getting your location..." data-fa="در حال دریافت موقعیت شما..." data-ku="شوێنەکەت وەردەگرین...">Getting your location...</p>
                <p class="text-sm text-gray-500 dark:text-gray-400 mt-2" id="permissionText" data-en="Please allow location access when prompted" data-fa="لطفاً هنگام درخواست، اجازه دسترسی به موقعیت مکانی را بدهید" data-ku="تکایە کاتێک داوات لێدەکرێت، ڕێگە بدە بە دەستگەیشتن بە شوێن">Please allow location access when prompted</p>
            </div>
        </div>

        <!-- Skeleton Loader -->
        <div id="skeleton-loader" class="hidden">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg overflow-hidden mb-4 animate-pulse">
                <div class="h-8 bg-gray-200 dark:bg-gray-700 mx-4 mt-4 rounded"></div>
                <div class="p-6 flex flex-col md:flex-row items-center gap-4">
                    <div class="h-16 w-16 rounded-full bg-gray-200 dark:bg-gray-700"></div>
                    <div class="flex-1 w-full">
                        <div class="h-4 bg-gray-200 dark:bg-gray-700 mb-3 rounded w-3/4"></div>
                        <div class="grid grid-cols-2 gap-4">
                            <div class="h-4 bg-gray-200 dark:bg-gray-700 rounded"></div>
                            <div class="h-4 bg-gray-200 dark:bg-gray-700 rounded"></div>
                            <div class="h-4 bg-gray-200 dark:bg-gray-700 rounded"></div>
                            <div class="h-4 bg-gray-200 dark:bg-gray-700 rounded"></div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Hourly forecast skeleton -->
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg overflow-hidden mb-4 animate-pulse">
                <div class="h-6 bg-gray-200 dark:bg-gray-700 mx-4 my-4 rounded w-1/3"></div>
                <div class="p-4 overflow-x-auto">
                    <div class="flex gap-3">
                        <div class="flex-shrink-0 w-16 h-20 bg-gray-200 dark:bg-gray-700 rounded-lg"></div>
                        <div class="flex-shrink-0 w-16 h-20 bg-gray-200 dark:bg-gray-700 rounded-lg"></div>
                        <div class="flex-shrink-0 w-16 h-20 bg-gray-200 dark:bg-gray-700 rounded-lg"></div>
                        <div class="flex-shrink-0 w-16 h-20 bg-gray-200 dark:bg-gray-700 rounded-lg"></div>
                        <div class="flex-shrink-0 w-16 h-20 bg-gray-200 dark:bg-gray-700 rounded-lg"></div>
                    </div>
                </div>
            </div>
            
            <!-- 7-day forecast skeleton -->
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg overflow-hidden mb-4 animate-pulse">
                <div class="h-6 bg-gray-200 dark:bg-gray-700 mx-4 my-4 rounded w-1/3"></div>
                <div class="p-4">
                    <div class="h-48 bg-gray-200 dark:bg-gray-700 rounded mb-4"></div>
                    <div class="flex gap-3 overflow-x-auto">
                        <div class="flex-shrink-0 w-28 h-32 bg-gray-200 dark:bg-gray-700 rounded-lg"></div>
                        <div class="flex-shrink-0 w-28 h-32 bg-gray-200 dark:bg-gray-700 rounded-lg"></div>
                        <div class="flex-shrink-0 w-28 h-32 bg-gray-200 dark:bg-gray-700 rounded-lg"></div>
                    </div>
                </div>
            </div>
        </div>

        <div id="weatherContainer" class="hidden">
            <!-- Current Weather Card -->
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg overflow-hidden mb-4">
                <div class="flex justify-between items-start px-4 pt-4">
                    <h2 id="locationName" class="text-2xl font-bold text-gray-800 dark:text-white"></h2>
                    <div class="flex items-center gap-2">
                        <button id="rename-location" class="p-2 text-gray-600 dark:text-gray-400 hover:text-primary dark:hover:text-primary transition-colors" title="Rename location" aria-label="Rename location">
                            <i class="ti ti-pencil text-xl"></i>
                        </button>
                        <button id="share-button" class="p-2 text-gray-600 dark:text-gray-400 hover:text-primary dark:hover:text-primary transition-colors" aria-label="Share weather information">
                            <i class="ti ti-share text-xl"></i>
                        </button>
                        <button id="favorite-button" class="p-2 text-gray-600 dark:text-gray-400 hover:text-primary dark:hover:text-primary transition-colors" aria-label="Add to favorites">
                            <i class="ti ti-star text-xl"></i>
                        </button>
                    </div>
                </div>
                
                <!-- Last Updated Time -->
                <div class="px-4 pt-1">
                    <p class="text-xs text-gray-500 dark:text-gray-400" id="last-updated">
                        <span data-en="Updated: " data-fa="بروزرسانی: " data-ku="نوێکراوەتەوە: ">Updated: </span>
                        <span id="update-time"></span>
                    </p>
                </div>
                
                <div id="weatherHeader" class="p-6 flex flex-col md:flex-row items-center gap-4">
                    <div id="weatherIconContainer" class="flex-shrink-0 weather-icon"></div>
                    <div class="flex-1">
                        <p id="weatherDescription" class="text-gray-600 dark:text-gray-300 mb-3 text-center md:text-left"></p>
                        <div class="flex flex-wrap gap-x-6 gap-y-2">
                            <div class="flex items-center">
                                <span class="text-gray-700 dark:text-gray-300 font-medium" data-en="Temperature:" data-fa="دما:" data-ku="پلەی گەرمی:">Temperature:</span>
                                <span id="temperature" class="ml-2 text-gray-900 dark:text-white"></span>
                            </div>
                            <div class="flex items-center">
                                <span class="text-gray-700 dark:text-gray-300 font-medium" data-en="Feels like:" data-fa="احساس دمایی:" data-ku="هەستکردن وەک:">Feels like:</span>
                                <span id="feelsLike" class="ml-2 text-gray-900 dark:text-white"></span>
                            </div>
                            <div class="flex items-center">
                                <span class="text-gray-700 dark:text-gray-300 font-medium" data-en="Humidity:" data-fa="رطوبت:" data-ku="شێ:">Humidity:</span>
                                <span id="humidity" class="ml-2 text-gray-900 dark:text-white"></span>
                            </div>
                            <div class="flex items-center">
                                <span class="text-gray-700 dark:text-gray-300 font-medium" data-en="Wind:" data-fa="باد:" data-ku="با:">Wind:</span>
                                <span id="wind" class="ml-2 text-gray-900 dark:text-white"></span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Expandable Weather Details -->
                <div class="px-6 pb-4">
                    <button id="details-toggle" class="w-full flex justify-between items-center text-gray-700 dark:text-gray-300 hover:text-primary dark:hover:text-primary focus:outline-none transition-colors" aria-expanded="false" aria-controls="details-content">
                        <span class="font-medium" data-en="Weather Details" data-fa="جزئیات آب و هوا" data-ku="وردەکاری کەشوهەوا">Weather Details</span>
                        <i class="ti ti-chevron-down transition-transform duration-200"></i>
                    </button>
                    
                    <div id="details-content" class="hidden mt-4 pt-4 border-t border-gray-200 dark:border-gray-700">
                        <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                            <div class="text-center">
                                <p class="text-sm text-gray-500 dark:text-gray-400" data-en="UV Index" data-fa="شاخص UV" data-ku="پێوەری UV">UV Index</p>
                                <p id="uv-index" class="text-lg font-medium text-gray-800 dark:text-white"></p>
                                <div id="uv-scale" class="w-full h-2 bg-gray-200 dark:bg-gray-700 rounded-full mt-1 overflow-hidden">
                                    <div id="uv-indicator" class="h-full rounded-full" style="width: 0%; background-color: #4ade80;"></div>
                                </div>
                            </div>
                            <div class="text-center">
                                <p class="text-sm text-gray-500 dark:text-gray-400" data-en="Precipitation" data-fa="بارش" data-ku="بارین">Precipitation</p>
                                <p id="precipitation" class="text-lg font-medium text-gray-800 dark:text-white"></p>
                                <div id="rain-scale" class="w-full h-2 bg-gray-200 dark:bg-gray-700 rounded-full mt-1 overflow-hidden">
                                    <div id="rain-indicator" class="h-full bg-blue-500 rounded-full" style="width: 0%;"></div>
                                </div>
                            </div>
                            <div class="text-center">
                                <p class="text-sm text-gray-500 dark:text-gray-400" data-en="Sunrise" data-fa="طلوع آفتاب" data-ku="هەڵاتنی خۆر">Sunrise</p>
                                <p id="sunrise" class="text-lg font-medium text-gray-800 dark:text-white"></p>
                                <p class="text-xs text-gray-500 dark:text-gray-400 mt-1"><i class="ti ti-sunrise"></i></p>
                            </div>
                            <div class="text-center">
                                <p class="text-sm text-gray-500 dark:text-gray-400" data-en="Sunset" data-fa="غروب آفتاب" data-ku="ئاوابوونی خۆر">Sunset</p>
                                <p id="sunset" class="text-lg font-medium text-gray-800 dark:text-white"></p>
                                <p class="text-xs text-gray-500 dark:text-gray-400 mt-1"><i class="ti ti-sunset"></i></p>
                            </div>
                        </div>
                        
                        <div class="mt-6 grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <p class="text-sm text-gray-500 dark:text-gray-400 mb-2 text-center" data-en="Wind Direction" data-fa="جهت باد" data-ku="ئاراستەی با">Wind Direction</p>
                                <div id="wind-compass" class="compass">
                                    <div class="compass-face">
                                        <div class="compass-direction">N</div>
                                        <div class="compass-direction" style="transform: rotate(90deg)">E</div>
                                        <div class="compass-direction" style="transform: rotate(180deg)">S</div>
                                        <div class="compass-direction" style="transform: rotate(270deg)">W</div>
                                        <div id="compass-arrow" class="compass-arrow"></div>
                                    </div>
                                </div>
                            </div>
                            <div>
                                <p class="text-sm text-gray-500 dark:text-gray-400 mb-2 text-center" data-en="Historical Comparison" data-fa="مقایسه تاریخی" data-ku="بەراوردی مێژوویی">Historical Comparison</p>
                                <div id="historical-comparison" class="text-center px-4 py-2 bg-gray-50 dark:bg-gray-700 rounded-lg">
                                    <p id="historical-text" class="text-sm text-gray-700 dark:text-gray-300" data-en="Loading historical data..." data-fa="در حال بارگذاری داده‌های تاریخی..." data-ku="زانیاری مێژوویی بار دەکرێت...">Loading historical data...</p>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Air Quality Section (NEW) -->
                        <div class="mt-6">
                            <p class="text-sm text-gray-500 dark:text-gray-400 mb-2 text-center" data-en="Air Quality" data-fa="کیفیت هوا" data-ku="کوالێتی هەوا">Air Quality</p>
                            <div id="air-quality-container" class="px-4 py-3 bg-gray-50 dark:bg-gray-700 rounded-lg">
                                <div class="flex justify-between items-center">
                                    <span class="text-sm text-gray-600 dark:text-gray-300" data-en="Not available" data-fa="در دسترس نیست" data-ku="بەردەست نییە">Not available</span>
                                    <div class="flex-1 mx-4">
                                        <div class="w-full h-3 rounded-full bg-gray-200 dark:bg-gray-600 overflow-hidden">
                                            <div id="air-quality-indicator" class="h-full bg-green-500" style="width: 0%"></div>
                                        </div>
                                    </div>
                                    <span id="air-quality-value" class="text-sm font-bold text-gray-800 dark:text-white">--</span>
                                </div>
                                <p id="air-quality-text" class="text-xs text-center mt-1 text-gray-600 dark:text-gray-400"></p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Hourly Forecast -->
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg overflow-hidden mb-4">
                <div class="p-4 border-b border-gray-200 dark:border-gray-700">
                    <h3 class="text-lg font-semibold text-gray-800 dark:text-white" data-en="24-Hour Forecast" data-fa="پیش‌بینی ۲۴ ساعته" data-ku="پێشبینی ٢٤ کاتژمێر">24-Hour Forecast</h3>
                </div>
                <div class="p-4 forecast-container">
                    <div id="hourlyForecastContent" class="flex gap-3 min-w-full"></div>
                </div>
            </div>
            
            <!-- Middle Ad Yektanet -->
            <div id="pos-article-display-card-105911" class="content-promotion horizontal mb-4"></div>
            
            <!-- 7-Day Forecast with Temperature Graph -->
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg overflow-hidden mb-6">
                <div class="p-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">
                    <h3 class="text-lg font-semibold text-gray-800 dark:text-white" data-en="7-Day Forecast" data-fa="پیش‌بینی ۷ روزه" data-ku="پێشبینی ٧ ڕۆژ">7-Day Forecast</h3>
                    
                    <!-- Chart Type Toggle -->
                    <div class="flex items-center gap-2">
                        <button id="chart-temp-btn" class="text-xs px-2 py-1 bg-primary text-white rounded-md" data-en="Temp" data-fa="دما" data-ku="پلە">Temp</button>
                        <button id="chart-precip-btn" class="text-xs px-2 py-1 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-md" data-en="Precip" data-fa="بارش" data-ku="بارین">Precip</button>
                    </div>
                </div>
                
                <div class="p-4">
                    <div class="mb-4 h-48">
                        <canvas id="weatherChart"></canvas>
                    </div>
                    
                    <div class="forecast-container pb-2">
                        <div id="forecastContent" class="flex gap-3 min-w-full"></div>
                    </div>
                </div>
            </div>
            
            <!-- Bottom Ad Yektanet -->
            <div id="pos-article-display-card-105911" class="content-promotion horizontal"></div>
        </div>
        
        <div id="errorContainer" class="hidden bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-100 p-4 rounded-lg mt-4">
            <div class="flex items-center">
                <i class="ti ti-alert-circle text-xl mr-2"></i>
                <p id="errorMessage"></p>
            </div>
            <div class="mt-3 flex flex-wrap gap-2">
                <button id="retry-btn" class="px-3 py-1 bg-red-200 dark:bg-red-800 text-red-700 dark:text-red-200 rounded-md text-sm hover:bg-red-300 dark:hover:bg-red-700 transition-colors">
                    <i class="ti ti-refresh mr-1"></i> <span data-en="Retry" data-fa="تلاش مجدد" data-ku="هەوڵدانەوە">Retry</span>
                </button>
                <button id="try-default-location-btn" class="px-3 py-1 bg-gray-200 dark:bg-gray-800 text-gray-700 dark:text-gray-200 rounded-md text-sm hover:bg-gray-300 dark:hover:bg-gray-700 transition-colors">
                    <i class="ti ti-map-pin mr-1"></i> <span data-en="Try Default Location" data-fa="امتحان مکان پیش‌فرض" data-ku="شوێنی بنەڕەتی تاقی بکەوە">Try Default Location</span>
                </button>
            </div>
        </div>

        <!-- SEO Content Section (hidden from view but visible to search engines) -->
        <div class="sr-only">
            <h2>Real-time Weather Forecasts for Any Location</h2>
            <p>SkySense Weather provides accurate, real-time weather forecasts for cities, towns, mountains, deserts, seas, and specific coordinates worldwide. Get current conditions, hourly updates, and 7-day forecasts to plan your activities with confidence.</p>
            
            <h2>Comprehensive Weather Information</h2>
            <p>Access detailed weather data including temperature, humidity, wind speed and direction, UV index, precipitation, sunrise and sunset times. Our forecasts help you prepare for changing weather conditions and stay safe during severe weather events.</p>
            
            <h2>Weather Alerts and Safety Recommendations</h2>
            <p>Receive timely alerts about severe weather conditions such as storms, heavy rain, snow, extreme temperatures, and strong winds. Each alert includes practical safety recommendations to help you stay safe.</p>
            
            <h2>Multi-language Support</h2>
            <p>SkySense Weather is available in multiple languages including English, Persian (Farsi), and Kurdish, making accurate weather information accessible to more people across different regions.</p>
            
            <h2>User-Friendly Features</h2>
            <p>Easily save your favorite locations, share weather information with friends and family, customize your dashboard, and switch between metric and imperial units for a personalized experience.</p>
        </div>
    </div>
    
    <!-- Location Name Modal -->
    <div id="locationNameModal" class="location-name-modal" role="dialog" aria-labelledby="locationNameTitle">
        <div class="location-name-content">
            <h3 id="locationNameTitle" class="text-xl font-semibold mb-4" data-en="Name this location" data-fa="نام‌گذاری این مکان" data-ku="ناوی ئەم شوێنە">Name this location</h3>
            <p class="text-sm text-gray-600 dark:text-gray-400 mb-4" data-en="Give this location a name you'll remember" data-fa="به این مکان نامی بدهید که به خاطر بسپارید" data-ku="ناوێک بدە بەم شوێنە کە لەبیرت بێت">Give this location a name you'll remember</p>
            
            <div class="mb-4">
                <input type="text" id="customLocationName" class="w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 text-base focus:outline-none focus:ring-2 focus:ring-primary dark:bg-gray-700 dark:text-white" placeholder="e.g. Home, Work, Favorite Beach..." aria-label="Custom location name">
            </div>
            
            <div class="flex justify-end gap-2">
                <button id="cancelLocationName" class="px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg" data-en="Cancel" data-fa="انصراف" data-ku="هەڵوەشاندنەوە">Cancel</button>
                <button id="saveLocationName" class="px-4 py-2 bg-primary text-white rounded-lg" data-en="Save" data-fa="ذخیره" data-ku="هەڵگرتن">Save</button>
            </div>
        </div>
    </div>
    
    <!-- Settings Modal -->
    <div id="settings-modal" class="fixed inset-0 z-50 hidden" role="dialog" aria-labelledby="settingsTitle">
        <div class="absolute inset-0 bg-black bg-opacity-50" id="settings-backdrop"></div>
        <div class="relative max-w-md mx-auto mt-20 bg-white dark:bg-gray-800 rounded-lg shadow-xl">
            <div class="p-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">
                <h3 id="settingsTitle" class="text-xl font-semibold text-gray-800 dark:text-white" data-en="Customize Dashboard" data-fa="شخصی‌سازی داشبورد" data-ku="ڕێکخستنی داشبۆرد">Customize Dashboard</h3>
                <button id="close-settings" class="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200" aria-label="Close dialog">
                    <i class="ti ti-x text-xl"></i>
                </button>
            </div>
            <div class="p-6">
                <p class="text-sm text-gray-600 dark:text-gray-400 mb-4" data-en="Select which weather elements to display:" data-fa="انتخاب کنید که کدام عناصر آب و هوا نمایش داده شوند:" data-ku="دیاری بکە کام ڕەگەزی کەشوهەوا پیشان بدرێت:">Select which weather elements to display:</p>
                
                <div class="space-y-4">
                    <div class="flex justify-between items-center">
                        <label for="show-hourly" class="text-gray-700 dark:text-gray-300" data-en="Hourly Forecast" data-fa="پیش‌بینی ساعتی" data-ku="پێشبینی کاتژمێری">Hourly Forecast</label>
                        <div class="relative inline-block">
                            <input type="checkbox" id="show-hourly" class="toggle-checkbox" checked />
                            <label for="show-hourly" class="toggle-label">
                                <span class="toggle-button"></span>
                            </label>
                        </div>
                    </div>
                    <div class="flex justify-between items-center">
                        <label for="show-details" class="text-gray-700 dark:text-gray-300" data-en="Weather Details" data-fa="جزئیات آب و هوا" data-ku="وردەکاری کەشوهەوا">Weather Details</label>
                        <div class="relative inline-block">
                            <input type="checkbox" id="show-details" class="toggle-checkbox" checked />
                            <label for="show-details" class="toggle-label">
                                <span class="toggle-button"></span>
                            </label>
                        </div>
                    </div>
                    <div class="flex justify-between items-center">
                        <label for="show-chart" class="text-gray-700 dark:text-gray-300" data-en="Temperature Chart" data-fa="نمودار دما" data-ku="هێڵکاری پلەی گەرمی">Temperature Chart</label>
                        <div class="relative inline-block">
                            <input type="checkbox" id="show-chart" class="toggle-checkbox" checked />
                            <label for="show-chart" class="toggle-label">
                                <span class="toggle-button"></span>
                            </label>
                        </div>
                    </div>
                    <div class="flex justify-between items-center">
                        <label for="show-alerts" class="text-gray-700 dark:text-gray-300" data-en="Weather Alerts" data-fa="هشدارهای آب و هوا" data-ku="ئاگاداریەکانی کەشوهەوا">Weather Alerts</label>
                        <div class="relative inline-block">
                            <input type="checkbox" id="show-alerts" class="toggle-checkbox" checked />
                            <label for="show-alerts" class="toggle-label">
                                <span class="toggle-button"></span>
                            </label>
                        </div>
                    </div>
                    <div class="flex justify-between items-center">
                        <label for="show-historical" class="text-gray-700 dark:text-gray-300" data-en="Historical Comparison" data-fa="مقایسه تاریخی" data-ku="بەراوردی مێژوویی">Historical Comparison</label>
                        <div class="relative inline-block">
                            <input type="checkbox" id="show-historical" class="toggle-checkbox" checked />
                            <label for="show-historical" class="toggle-label">
                                <span class="toggle-button"></span>
                            </label>
                        </div>
                    </div>
                    
                    <!-- NEW: Data Refresh Setting -->
                    <div class="mt-6 pt-4 border-t border-gray-200 dark:border-gray-700">
                        <h4 class="text-sm font-medium text-gray-700 dark:text-gray-300 mb-3" data-en="Update Frequency" data-fa="دفعات بروزرسانی" data-ku="چەندبارەی نوێکردنەوە">Update Frequency</h4>
                        <div class="flex justify-between items-center">
                            <label for="auto-refresh" class="text-gray-700 dark:text-gray-300" data-en="Auto-refresh weather" data-fa="بروزرسانی خودکار آب و هوا" data-ku="نوێکردنەوەی خۆکاری کەشوهەوا">Auto-refresh weather</label>
                            <div class="relative inline-block">
                                <input type="checkbox" id="auto-refresh" class="toggle-checkbox" checked />
                                <label for="auto-refresh" class="toggle-label">
                                    <span class="toggle-button"></span>
                                </label>
                            </div>
                        </div>
                        <div class="mt-2">
                            <label for="refresh-interval" class="block text-sm text-gray-700 dark:text-gray-300 mb-1" data-en="Refresh interval" data-fa="فاصله بروزرسانی" data-ku="ماوەی نوێکردنەوە">Refresh interval</label>
                            <select id="refresh-interval" class="w-full px-3 py-2 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md text-gray-700 dark:text-gray-300">
                                <option value="300000" data-en="5 minutes" data-fa="۵ دقیقه" data-ku="٥ خولەک">5 minutes</option>
                                <option value="600000" selected data-en="10 minutes" data-fa="۱۰ دقیقه" data-ku="١٠ خولەک">10 minutes</option>
                                <option value="1800000" data-en="30 minutes" data-fa="۳۰ دقیقه" data-ku="٣٠ خولەک">30 minutes</option>
                                <option value="3600000" data-en="1 hour" data-fa="۱ ساعت" data-ku="١ کاتژمێر">1 hour</option>
                            </select>
                        </div>
                    </div>
                    
                    <!-- NEW: Data Saving Mode -->
                    <div class="mt-4 pt-4 border-t border-gray-200 dark:border-gray-700">
                        <div class="flex justify-between items-center">
                            <div>
                                <label for="data-saver" class="text-gray-700 dark:text-gray-300" data-en="Data Saver Mode" data-fa="حالت صرفه‌جویی در مصرف داده" data-ku="شێوازی پاشەکەوتی داتا">Data Saver Mode</label>
                                <p class="text-xs text-gray-500 dark:text-gray-400 mt-1" data-en="Reduce data usage and load times" data-fa="کاهش مصرف داده و زمان بارگذاری" data-ku="کەمکردنەوەی بەکارهێنانی داتا و کاتی بارکردن">Reduce data usage and load times</p>
                            </div>
                            <div class="relative inline-block">
                                <input type="checkbox" id="data-saver" class="toggle-checkbox" />
                                <label for="data-saver" class="toggle-label">
                                    <span class="toggle-button"></span>
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="mt-8 text-right">
                    <button id="save-settings" class="px-4 py-2 bg-primary text-white rounded-lg hover:bg-opacity-90 transition-colors" data-en="Save Preferences" data-fa="ذخیره تنظیمات" data-ku="هەڵگرتنی ڕێکخستنەکان">
                        Save Preferences
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Share Modal -->
    <div id="share-modal" class="fixed inset-0 z-50 hidden" role="dialog" aria-labelledby="shareTitle">
        <div class="absolute inset-0 bg-black bg-opacity-50" id="share-backdrop"></div>
        <div class="relative max-w-md mx-auto mt-20 bg-white dark:bg-gray-800 rounded-lg shadow-xl">
            <div class="p-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">
                <h3 id="shareTitle" class="text-xl font-semibold text-gray-800 dark:text-white" data-en="Share Weather" data-fa="اشتراک‌گذاری آب و هوا" data-ku="هاوبەشکردنی کەشوهەوا">Share Weather</h3>
                <button id="close-share" class="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200" aria-label="Close dialog">
                    <i class="ti ti-x text-xl"></i>
                </button>
            </div>
            <div class="p-6">
                <p class="text-sm text-gray-600 dark:text-gray-400 mb-4" data-en="Share this weather information with others:" data-fa="این اطلاعات آب و هوا را با دیگران به اشتراک بگذارید:" data-ku="ئەم زانیاریانەی کەشوهەوا لەگەڵ کەسانی تر هاوبەش بکە:">Share this weather information with others:</p>
                
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2" data-en="Share Link" data-fa="لینک اشتراک‌گذاری" data-ku="بەستەری هاوبەشکردن">Share Link</label>
                    <div class="flex">
                        <input type="text" id="share-url" class="flex-1 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-l-lg text-base focus:outline-none focus:ring-2 focus:ring-primary dark:bg-gray-700 dark:text-white" readonly aria-label="Share URL">
                        <button id="copy-link" class="px-4 py-2 bg-primary text-white rounded-r-lg hover:bg-opacity-90 transition-colors" aria-label="Copy to clipboard">
                            <i class="ti ti-copy"></i>
                        </button>
                    </div>
                </div>
                
                <!-- Share as Image Option (NEW) -->
                <div class="mb-6">
                    <button id="share-as-image" class="w-full flex items-center justify-center gap-2 py-2 bg-primary bg-opacity-10 text-primary border border-primary rounded-lg hover:bg-opacity-20 transition-colors">
                        <i class="ti ti-photo"></i>
                        <span data-en="Create Shareable Image" data-fa="ایجاد تصویر قابل اشتراک" data-ku="دروستکردنی وێنەی هاوبەشکراو">Create Shareable Image</span>
                    </button>
                    <div id="share-image-container" class="hidden mt-4 border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-2">
                        <div id="weather-image-preview" class="bg-white dark:bg-gray-800 rounded-lg overflow-hidden"></div>
                        <div class="mt-2 flex justify-end">
                            <button id="download-image" class="px-3 py-1 bg-primary text-white text-sm rounded-lg hover:bg-opacity-90 transition-colors">
                                <i class="ti ti-download mr-1"></i> <span data-en="Save Image" data-fa="ذخیره تصویر" data-ku="هەڵگرتنی وێنە">Save Image</span>
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="mt-4 flex justify-center gap-4">
                    <a href="#" id="share-twitter" class="p-3 bg-[#1DA1F2] text-white rounded-full hover:bg-opacity-90 transition-colors" target="_blank" aria-label="Share on Twitter">
                        <i class="ti ti-brand-twitter text-xl"></i>
                    </a>
                    <a href="#" id="share-facebook" class="p-3 bg-[#1877F2] text-white rounded-full hover:bg-opacity-90 transition-colors" target="_blank" aria-label="Share on Facebook">
                        <i class="ti ti-brand-facebook text-xl"></i>
                    </a>
                    <a href="#" id="share-whatsapp" class="p-3 bg-[#25D366] text-white rounded-full hover:bg-opacity-90 transition-colors" target="_blank" aria-label="Share on WhatsApp">
                        <i class="ti ti-brand-whatsapp text-xl"></i>
                    </a>
                    <a href="#" id="share-telegram" class="p-3 bg-[#0088cc] text-white rounded-full hover:bg-opacity-90 transition-colors" target="_blank" aria-label="Share on Telegram">
                        <i class="ti ti-brand-telegram text-xl"></i>
                    </a>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Favorites Management Modal -->
    <div id="favorites-modal" class="fixed inset-0 z-50 hidden" role="dialog" aria-labelledby="favoritesTitle">
        <div class="absolute inset-0 bg-black bg-opacity-50" id="favorites-backdrop"></div>
        <div class="relative max-w-md mx-auto mt-20 bg-white dark:bg-gray-800 rounded-lg shadow-xl">
            <div class="p-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">
                <h3 id="favoritesTitle" class="text-xl font-semibold text-gray-800 dark:text-white" data-en="Manage Favorites" data-fa="مدیریت علاقه‌مندی‌ها" data-ku="بەڕێوەبردنی دڵخوازەکان">Manage Favorites</h3>
                <button id="close-favorites" class="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200" aria-label="Close dialog">
                    <i class="ti ti-x text-xl"></i>
                </button>
            </div>
            <div class="p-6">
                <div id="no-favorites" class="hidden text-center py-6 text-gray-500 dark:text-gray-400">
                    <i class="ti ti-star text-4xl mb-2"></i>
                    <p data-en="No favorite locations yet" data-fa="هنوز مکان مورد علاقه‌ای ثبت نشده است" data-ku="هێشتا هیچ شوێنێکی دڵخواز تۆمار نەکراوە">No favorite locations yet</p>
                </div>
                
                <ul id="favorites-management-list" class="divide-y divide-gray-200 dark:divide-gray-700 max-h-[50vh] overflow-y-auto"></ul>
                
                <div class="mt-6 text-right">
                    <button id="done-favorites" class="px-4 py-2 bg-primary text-white rounded-lg hover:bg-opacity-90 transition-colors" data-en="Done" data-fa="انجام شد" data-ku="تەواو">
                        Done
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Toast for location services -->
    <div id="location-toast" class="toast hidden" role="alert" aria-live="polite">
        <i class="ti ti-map-pin text-xl"></i>
        <span id="toast-message"></span>
    </div>
    
    <!-- Image Export (Hidden Canvas) -->
    <div class="hidden">
        <canvas id="share-canvas" width="600" height="800"></canvas>
    </div>

    <!-- Import JavaScript files -->
    <script src="weather-data.js"></script>
    <script src="ui-handlers.js"></script>
    <script src="app.js"></script>
    
    <!-- Register Service Worker -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js')
                    .then(registration => {
                        console.log('Service Worker registered with scope:', registration.scope);
                    })
                    .catch(error => {
                        console.error('Service Worker registration failed:', error);
                    });
            });
        }
    </script>
</body>
</html>
